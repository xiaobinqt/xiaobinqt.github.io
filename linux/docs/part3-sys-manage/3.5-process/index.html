<!DOCTYPE html>
<html lang="zh" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="3.5 进程管理 # 进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的。
以 C 程序为例，程序的启动是从 main 函数开始的：
int main(int agrc,char *argv[]) 程序终止的方式并不唯一，可以分为正常终止和异常终止。正常终止也分为从 main 返回、调用 exit 等方式。异常终止分为调用 abort、接收信号等。
3.5.1 进程查看 # ps # ps 可以查看当前系统的进程状态。
-e 选项 显示所有程序。
-f 选项 常搭配 -e 选项使用。显示 UID（有效用户ID），PPID（父进程）等信息，进程由哪个用户启动的，有时启动用户和运行用户可能不一样，比如 Nginx 由 root 启动，但是实际的运行身份是 nobody。
-L 选线 进程中的线程，LWP 轻量级进程也就是线程。
pstree # 如果没有 pstree 命令可以自行安装。
yum install psmisc -y top # top 可以实时动态地查看系统的整体运行情况，是一个综合了多方信息监测系统性能和运行信息的实用工具。
top 界面主要分为两个部分，前 5 行展示的是系统的整体性能，光标下面部分是系统中每个进程的具体信息。光标所在处是用来输入操作命令的。
系统的整体性能 # 第一行：
top - 14:39:05 up 36 days, 21:26, 3 users, load average: 56.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="3.5 进程管理" />
<meta property="og:description" content="3.5 进程管理 # 进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的。
以 C 程序为例，程序的启动是从 main 函数开始的：
int main(int agrc,char *argv[]) 程序终止的方式并不唯一，可以分为正常终止和异常终止。正常终止也分为从 main 返回、调用 exit 等方式。异常终止分为调用 abort、接收信号等。
3.5.1 进程查看 # ps # ps 可以查看当前系统的进程状态。
-e 选项 显示所有程序。
-f 选项 常搭配 -e 选项使用。显示 UID（有效用户ID），PPID（父进程）等信息，进程由哪个用户启动的，有时启动用户和运行用户可能不一样，比如 Nginx 由 root 启动，但是实际的运行身份是 nobody。
-L 选线 进程中的线程，LWP 轻量级进程也就是线程。
pstree # 如果没有 pstree 命令可以自行安装。
yum install psmisc -y top # top 可以实时动态地查看系统的整体运行情况，是一个综合了多方信息监测系统性能和运行信息的实用工具。
top 界面主要分为两个部分，前 5 行展示的是系统的整体性能，光标下面部分是系统中每个进程的具体信息。光标所在处是用来输入操作命令的。
系统的整体性能 # 第一行：
top - 14:39:05 up 36 days, 21:26, 3 users, load average: 56." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/linux/docs/part3-sys-manage/3.5-process/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2023-02-21T13:52:42+08:00" />
<title>3.5 进程管理 | Linux 学习笔记</title>
<link rel="manifest" href="/linux/manifest.json">
<link rel="icon" href="/linux/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/linux/book.min.cad59a3be22b32d901c8b99a5bf0c00f01535383d8d0e86742e5449f598d17af.css" integrity="sha256-ytWaO&#43;IrMtkByLmaW/DADwFTU4PY0OhnQuVEn1mNF68=" crossorigin="anonymous">
  <script defer src="/linux/flexsearch.min.js"></script>
  <script defer src="/linux/zh.search.min.74d4397413e7da842e1e5d18b17a66f920b890ef0d369b7efbb776a5ffece23f.js" integrity="sha256-dNQ5dBPn2oQuHl0YsXpm&#43;SC4kO8NNpt&#43;&#43;7d2pf/s4j8=" crossorigin="anonymous"></script>

  <script defer src="/linux/sw.min.e3338ad661715b83bfd6397040a613605d8bb26c10798773e2176216e2123560.js" integrity="sha256-4zOK1mFxW4O/1jlwQKYTYF2LsmwQeYdz4hdiFuISNWA=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/linux/"><span>Linux 学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>




<ul>
    <li>
        <a href="javascript:void(0)" onclick="hrefIndex()" rel="noopener">主页</a>
    </li>
    <li>
        <a href="https://github.com/xiaobinqt" target="_blank" rel="noopener">GitHub</a>
    </li>
</ul>

<hr>

<script>
    function hrefIndex() {
        window.location = window.location.origin;
    }
</script>


  
<ul>
  
  <li>
    <a href=""  target="_blank" rel="noopener">
        
      </a>
  </li>
  
</ul>







  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>第一部分 基础知识</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.1-operating-system/" class="">1.1 操作系统</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.2-overview/" class="">1.2 总览</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.3-common-dir/" class="">1.3 常见目录</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.4-process-manage/" class="">1.4 进程管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.5-deadlock/" class="">1.5 死锁</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.6-memory-manage/" class="">1.6 内存管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.7-link/" class="">1.7 链接</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.7-device-manage/" class="">1.7 设备管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part1-primary/1.8-instruction-arch/" class="">1.8 指令集</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第二部分 系统操作</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.1-help/" class="">2.1 帮助命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.2-ls/" class="">2.2 ls 命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.3-shutdown/" class="">2.3 关机</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.4-cp/" class="">2.4 cp 命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.5-file-view/" class="">2.5 文件查看命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.6-backup-compression/" class="">2.6 压缩和打包</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.7-vim/" class="">2.7 vim</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.8-user-manage/" class="">2.8 用户管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.9-switch-user/" class="">2.9 切换用户</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part2-sys-operate/2.10-file-dir/" class="">2.10 文件和文件夹</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第三部分 系统管理</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.1-network/" class="">3.1 网络</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.2-net-trouble-removal/" class="">3.2 网络故障排除</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.3-net-manage/" class="">3.3 网络服务管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.4-soft-install/" class="">3.4 软件安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.5-process/" class="active">3.5 进程管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part3-sys-manage/3.6-memory-disk/" class="">3.6 内存和磁盘管理</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第四部分 Shell</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.1-introduction/" class="">4.1 Shell 简介</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.2-env-config-file/" class="">4.2 环境变量</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.3-array/" class="">4.3 数组</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.4-escape-quot/" class="">4.4 转义和引用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.5-operator/" class="">4.5 运算符</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.6-test-and-judge/" class="">4.6 测试和判断</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.7-process-control/" class="">4.7 流程控制</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.8-function/" class="">4.8 函数</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part4-shell/4.9-script-cron/" class="">4.9 脚本和计划任务</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第五部分 文本操作</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part5-text-operate/5.1-regular/" class="">5.1 正则表达式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part5-text-operate/5.2-sed/" class="">5.2 sed 命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part5-text-operate/5.3-awk/" class="">5.3 awk 命令</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part5-text-operate/5.4-cut-sort-uniq-tr/" class="">5.4 cut、sort、uniq、tr 命令</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第六部分 服务管理</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part6-service-manage/6.1-firewall/" class="">6.1 防火墙</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part6-service-manage/6.2-ssh/" class="">6.2 ssh</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part6-service-manage/6.3-ftp/" class="">6.3 ftp</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part6-service-manage/6.4-samba/" class="">6.4 samba</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part6-service-manage/6.5-nfs/" class="">6.5 NFS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第七部分 常见问题</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/linux/docs/part7-faq/7.1-cmd/" class="">7.1 命令相关</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/linux/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>3.5 进程管理</strong>

  <label for="toc-control">
    
    <img src="/linux/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#35-进程管理">3.5 进程管理</a>
      <ul>
        <li><a href="#351-进程查看">3.5.1 进程查看</a>
          <ul>
            <li><a href="#ps">ps</a></li>
            <li><a href="#pstree">pstree</a></li>
            <li><a href="#top">top</a></li>
          </ul>
        </li>
        <li><a href="#352-进程的控制命令">3.5.2 进程的控制命令</a>
          <ul>
            <li><a href="#调整优先级">调整优先级</a></li>
            <li><a href="#作业控制">作业控制</a></li>
            <li><a href="#jobs">jobs</a></li>
          </ul>
        </li>
        <li><a href="#353-进程的通信方式">3.5.3 进程的通信方式</a>
          <ul>
            <li><a href="#信号">信号</a></li>
          </ul>
        </li>
        <li><a href="#355-守护进程和系统日志">3.5.5 守护进程和系统日志</a>
          <ul>
            <li><a href="#nohup">nohup</a></li>
            <li><a href="#daemon">daemon</a></li>
            <li><a href="#screen">screen</a></li>
            <li><a href="#常见系统日志">常见系统日志</a></li>
          </ul>
        </li>
        <li><a href="#355-systemctl">3.5.5 systemctl</a>
          <ul>
            <li><a href="#常见操作">常见操作</a></li>
          </ul>
        </li>
        <li><a href="#351-selinux-简介">3.5.1 SELinux 简介</a>
          <ul>
            <li><a href="#自主式dac">自主式（DAC）</a></li>
            <li><a href="#委任式mac">委任式（MAC）</a></li>
            <li><a href="#常见命令">常见命令</a></li>
          </ul>
        </li>
        <li><a href="#参考">参考</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="35-进程管理">
  3.5 进程管理
  <a class="anchor" href="#35-%e8%bf%9b%e7%a8%8b%e7%ae%a1%e7%90%86">#</a>
</h1>
<p>进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的。</p>
<p>以 C 程序为例，程序的启动是从 main 函数开始的：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> agrc,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>argv[])
</span></span></code></pre></div><p>程序终止的方式并不唯一，可以分为正常终止和异常终止。正常终止也分为从 main 返回、调用 exit 等方式。异常终止分为调用 abort、接收信号等。</p>
<h2 id="351-进程查看">
  3.5.1 进程查看
  <a class="anchor" href="#351-%e8%bf%9b%e7%a8%8b%e6%9f%a5%e7%9c%8b">#</a>
</h2>
<h3 id="ps">
  ps
  <a class="anchor" href="#ps">#</a>
</h3>
<p>ps 可以查看当前系统的进程状态。</p>
<ul>
<li>-e 选项</li>
</ul>
<p>显示所有程序。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/0163dcdf05174a82a7147f2aa79d44fb.png" width=  /></div>
<ul>
<li>-f 选项</li>
</ul>
<p>常搭配 -e 选项使用。显示 UID（有效用户ID），PPID（父进程）等信息，进程由哪个用户启动的，有时启动用户和运行用户可能不一样，比如 Nginx 由 root 启动，但是实际的运行身份是 nobody。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/a2d1bd172bc8455ebe444bb28509c456.png" width=  /></div>
<ul>
<li>-L 选线</li>
</ul>
<p>进程中的线程，LWP 轻量级进程也就是线程。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/e0ab3cb92b424f0b89e4ecb1969dac66.png" width=  /></div>
<h3 id="pstree">
  pstree
  <a class="anchor" href="#pstree">#</a>
</h3>
<p>如果没有 pstree 命令可以自行安装。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install psmisc -y 
</span></span></code></pre></div><div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/00ffd1f1be0c430382ba7c304a114b22.png" width=  /></div>
<h3 id="top">
  top
  <a class="anchor" href="#top">#</a>
</h3>
<p>top 可以实时动态地查看系统的整体运行情况，是一个综合了多方信息监测系统性能和运行信息的实用工具。</p>
<p>top 界面主要分为两个部分，前 5 行展示的是系统的整体性能，光标下面部分是系统中每个进程的具体信息。光标所在处是用来输入操作命令的。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/9a4546b616e4433484a0710f5135fb40.png" width=  /></div>
<h4 id="系统的整体性能">
  系统的整体性能
  <a class="anchor" href="#%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%95%b4%e4%bd%93%e6%80%a7%e8%83%bd">#</a>
</h4>
<p><strong>第一行：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>top <span style="color:#f92672">-</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">39</span><span style="color:#f92672">:</span><span style="color:#ae81ff">05</span> up <span style="color:#ae81ff">36</span> days, <span style="color:#ae81ff">21</span><span style="color:#f92672">:</span><span style="color:#ae81ff">26</span>,  <span style="color:#ae81ff">3</span> users,  load average: <span style="color:#ae81ff">56.31</span>, <span style="color:#ae81ff">55.92</span>, <span style="color:#ae81ff">56.03</span>
</span></span></code></pre></div><ul>
<li>top：名称</li>
<li>14:39:05：系统当前时间</li>
<li>up 36 days, 21:26：系统以及运行的时间，和 uptime 命令相等</li>
<li>3 users：当前有 3 个用户在线</li>
<li>load average: 56.31, 55.92, 56.03：系统一定时间内的平均负载，分别是 1 分钟、5 分钟、15 分钟。</li>
</ul>
<p>主要关注<strong>load average</strong>这个值，所谓系统负载就是：<strong>在一段时间内，CPU 正在处理以及等待 CPU 处理的进程数之和</strong>。系统在同一时间运行的进程数和系统 CPU 核数相关，一般来说 Load Average 的数值别超过这台机器的总核数，就没什么问题。</p>
<p><strong>第二行：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>Tasks: <span style="color:#ae81ff">265</span> total,   <span style="color:#ae81ff">2</span> running, <span style="color:#ae81ff">263</span> sleeping,   <span style="color:#ae81ff">0</span> stopped,   <span style="color:#ae81ff">0</span> zombie
</span></span></code></pre></div><ul>
<li>Tasks：任务，也就是进程</li>
<li>265 total：当前总共有 265 个任务，也就是 265 个进程</li>
<li>2 running：2 个进程正在运行</li>
<li>263 sleeping：263 个进程正在休眠</li>
<li>0 stopped：0 个停止的进程</li>
<li>0 zombie：1 个僵尸进程</li>
</ul>
<p><strong>第三行：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#f92672">%</span><span style="color:#a6e22e">Cpu</span>(s)<span style="color:#f92672">:</span> <span style="color:#ae81ff">88.9</span> us,  <span style="color:#ae81ff">7.9</span> sy,  <span style="color:#ae81ff">0.0</span> ni,  <span style="color:#ae81ff">1.7</span> id,  <span style="color:#ae81ff">0.0</span> wa,  <span style="color:#ae81ff">1.4</span> hi,  <span style="color:#ae81ff">0.0</span> si,  <span style="color:#ae81ff">0.0</span> st
</span></span></code></pre></div><ul>
<li>%Cpu(s)：CPU 使用率</li>
<li>88.9 us：用户空间占用 CPU 时间的百分比（大部分进程都运行在用户态，通常都是希望用户空间 CPU 越高越好）</li>
<li>7.9 sy：内核空间占用 CPU 时间的百分比（Linux 内核态占用的 CPU 时间，系统 CPU 占用越高，表明系统某部分存在瓶颈。通常这个值越低越好）</li>
<li>0.0 ni：占用 CPU 时间的百分比（ni 是 nice 的缩写，进程用户态的优先级，如果调整过优先级，那么展示的就是调整过 nice 值的进程消耗掉的CPU 时间，如果系统中没有进程被调整过 nice 值，那么 ni 就显示为 0）</li>
<li>1.7 id：空闲 CPU 占用率，等待进程运行</li>
<li>0.0 wa：等待输入输出的 CPU 时间百分比（CPU 的处理速度是很快的，磁盘 IO 操作是非常慢的。wa 表示 CPU 在等待 IO 操作完成所花费的时间。<strong>系统不应该花费大量的时间来等待 IO 操作，否则就说明 IO 存在瓶颈</strong>）</li>
<li>1.4 hi：CPU 硬中断时间百分比（硬中断是硬盘、网卡等硬件设备发送给 CPU 的中断消息）</li>
<li>0.0 si：CPU 软中断时间百分比（软中断是由程序发出的中断 ）</li>
<li>0.0 st：被强制等待（involuntary wait）虚拟 CPU 的时间，此时 Hypervisor 在为另一个虚拟处理器服务。</li>
</ul>
<p><strong>第四行：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>MiB Mem :  <span style="color:#ae81ff">15508.4</span> total,   <span style="color:#ae81ff">3858.4</span> free,   <span style="color:#ae81ff">3369.3</span> used,   <span style="color:#ae81ff">828.07</span> buff<span style="color:#f92672">/</span>cache
</span></span></code></pre></div><ul>
<li>MiB Mem：内存</li>
<li>15508.4 total：物理内存总量</li>
<li>3858.4 free：空闲内存量</li>
<li>3369.3 used：已使用的内存量</li>
<li>828.07 buff/cache：用作内核缓存的内存量</li>
</ul>
<p><strong>第五行：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>MiB Swap:   <span style="color:#ae81ff">4096.0</span> total,   <span style="color:#ae81ff">3855.1</span> free,    <span style="color:#ae81ff">240.9</span> used.  <span style="color:#ae81ff">10823.7</span> avail Mem
</span></span></code></pre></div><ul>
<li>MiB Swap：交换空间（虚拟内存，当内存不足的时候，把一部分硬盘空间虚拟城内存使用）</li>
<li>4096.0 total：交换区总量</li>
<li>3855.1 free：空闲交换区总量</li>
<li>240.9 used：使用的交换区总量</li>
<li>10823.7 avail Mem：可用于启动一个新应用的内存（物理内存），和 free 不同，它计算的是可回收的 page cache 和 memory slab</li>
</ul>
<p>第四行和第五行输出信息，等同于使用 free -m 命令。</p>
<h4 id="进程信息">
  进程信息
  <a class="anchor" href="#%e8%bf%9b%e7%a8%8b%e4%bf%a1%e6%81%af">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span> PID USER      PR  NI    VIRT    RES    SHR S  <span style="color:#f92672">%</span>CPU  <span style="color:#f92672">%</span>MEM     TIME<span style="color:#f92672">+</span> COMMAND
</span></span></code></pre></div><ul>
<li>PID：进程 id</li>
<li>USER：进程所有者</li>
<li>PR：进程的优先级，越小优先级越高</li>
<li>NI：nice 值，负值表示高优先级，正值表示低优先级</li>
<li>VIRT：进程使用的虚拟内存，单位是 kb</li>
<li>RES：进程使用的物理内存，单位 kb</li>
<li>SHR：进程使用的共享内存，单位 kb</li>
<li>S：进程状态（S 表示休眠，R 表示正在运行，Z 表示僵死状态，N 表示该进程优先值为负数，I 表示空闲状态）</li>
<li>%CPU：进程占用的 CPU 使用率</li>
<li>%MEM：进程使用的物理内存和总内存的百分比</li>
<li>TIME+：进程使用的 CPU 时间总计，单位 1/100 秒</li>
<li>COMMAND：命令行</li>
</ul>
<p>上述列是 top 命令的默认显示，还有一些参数可以使用 top 的交互命令选择显示，按 f 键，选择需要展示的部分。</p>
<h4 id="命令行选项">
  命令行选项
  <a class="anchor" href="#%e5%91%bd%e4%bb%a4%e8%a1%8c%e9%80%89%e9%a1%b9">#</a>
</h4>
<p>格式：top [选项]</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>-p</td>
<td>只显示某个进程的信息</td>
</tr>
<tr>
<td>-d</td>
<td>设置刷新时间，默认是5s</td>
</tr>
<tr>
<td>-c</td>
<td>显示产生进程的完整命令，默认是进程名</td>
</tr>
<tr>
<td>-o</td>
<td>指定要排序的字段，比如 top -o PID 按照 PID 从大到小，top -o -PID 按照 PID 从小到大</td>
</tr>
<tr>
<td>-n</td>
<td>指定刷新次数，比如 top -n 3，刷新输出3次后退出</td>
</tr>
<tr>
<td>-b</td>
<td>以非交互非全屏模式运行，以批次的方式执行top，一般配合-n指定输出几次统计信息，将输出重定向到指定文件，比如 <code>top -b -n 3 &gt; /tmp/top.tmp</code></td>
</tr>
<tr>
<td>-i</td>
<td>不显示任何闲置 (idle) 或无用 (zombie) 的进程</td>
</tr>
<tr>
<td>-u</td>
<td>查找特定用户启动的进程</td>
</tr>
</tbody>
</table>
<h4 id="交互命令">
  交互命令
  <a class="anchor" href="#%e4%ba%a4%e4%ba%92%e5%91%bd%e4%bb%a4">#</a>
</h4>
<p>top命令在执行过程中可以使用一些交互功能：</p>
<table>
<thead>
<tr>
<th>按键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>h 键</td>
<td>按下h键，会显示帮助画面</td>
</tr>
<tr>
<td>c 键</td>
<td>按下c键，会显示产生进程的完整命令，等同于-c参数，再次按下c键，变为默认显示</td>
</tr>
<tr>
<td>f 键</td>
<td>按下f键，可以选择需要展示的项目</td>
</tr>
<tr>
<td>M 键</td>
<td>按下M键，根据驻留内存大小（RES）排序</td>
</tr>
<tr>
<td>P 键</td>
<td>按下P键，根据CPU使用百分比大小进行排序</td>
</tr>
<tr>
<td>T 键</td>
<td>按下T键，根据时间/累计时间进行排序</td>
</tr>
<tr>
<td>E 键</td>
<td>按下E键，切换顶部内存显示单位</td>
</tr>
<tr>
<td>e 键</td>
<td>按下e键，切换进程内存显示单位</td>
</tr>
<tr>
<td>l 键</td>
<td>按下l键，切换显示平均负载和启动时间信息。</td>
</tr>
<tr>
<td>t 键</td>
<td>按下t键，切换显示CPU状态信息</td>
</tr>
<tr>
<td>m 键</td>
<td>按下m键，切换显示内存信息</td>
</tr>
</tbody>
</table>
<h4 id="virtresshr含义">
  VIRT、RES、SHR含义
  <a class="anchor" href="#virtresshr%e5%90%ab%e4%b9%89">#</a>
</h4>
<p>VIRT:</p>
<ol>
<li>进程 “需要的” 虚拟内存大小，包括进程使用的库、代码、数据，以及 malloc、new 分配的堆空间和分配的栈空间等；</li>
<li>假如进程新申请 10MB 的内存，但实际只使用了 1MB，那么它会增长 10MB，而不是实际的 1MB 使用量。</li>
</ol>
<p>RES:</p>
<ol>
<li>进程当前使用的内存大小，包括使用中的 malloc、new 分配的堆空间和分配的栈空间，但不包括 swap out 量；</li>
<li>包含其他进程的共享；</li>
<li>如果申请 10MB 的内存，实际使用 1MB，它只增长 1MB；</li>
</ol>
<p>SHR:</p>
<ol>
<li>进程当前使用的内存大小，包括使用中的 malloc、new 分配的堆空间和分配的栈空间，但不包括 swap out 量；</li>
<li>包含其他进程的共享；</li>
<li>如果申请 10MB 的内存，实际使用 1MB，它只增长 1MB；</li>
</ol>
<p>上述三个值是从 /proc/pid/statm 文件中格式化读出来的，前三个值分别是 VIRT、RES、SHR，单位是页，常见的是 4kb。</p>
<h2 id="352-进程的控制命令">
  3.5.2 进程的控制命令
  <a class="anchor" href="#352-%e8%bf%9b%e7%a8%8b%e7%9a%84%e6%8e%a7%e5%88%b6%e5%91%bd%e4%bb%a4">#</a>
</h2>
<h3 id="调整优先级">
  调整优先级
  <a class="anchor" href="#%e8%b0%83%e6%95%b4%e4%bc%98%e5%85%88%e7%ba%a7">#</a>
</h3>
<ul>
<li>nice 范围从 -20 到 19，值越小优先级越高，抢占资源就越多</li>
</ul>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/027381e2da6841d8b6dd42354c9ce1cd.png" width=  /></div>
<ul>
<li>renice 重新设置优先级</li>
</ul>
<p>当服务在运行的时候想调整优先级，可以用 renice 设置。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/17d3b0d162e6431d8e09f0796caf303e.png" width=  /></div>
<h3 id="作业控制">
  作业控制
  <a class="anchor" href="#%e4%bd%9c%e4%b8%9a%e6%8e%a7%e5%88%b6">#</a>
</h3>
<p>作业控制是一个命令行功能，也叫后台运行。</p>
<p>goreground（fg）：前台进程，是在终端中运行的命令，占领终端。</p>
<p>background（bg）：后台进程，没有控制终端，他不需要终端的交互，看不到，但是在运行。可以使用 &amp; 符号让服务在后台运行。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/2c08f3741b05433280b88e345749df6f.png" width=  /></div>
<p>如果想要挂起程序，可以使用 ctrl+z。如下，这是用<code>top -p 89781</code> 就可以看到是 stopped 的状态。如果想让再恢复运行，可以使用 fg 或 bg 唤醒。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/9394dd243cd8449e98b8e268f191344a.png" width=  /></div>
<h3 id="jobs">
  jobs
  <a class="anchor" href="#jobs">#</a>
</h3>
<p>如何想让后台运行的程序调回前台，可以用 jobs。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/a1137781354346819a5654b0410e944e.png" width=  /></div>
<h2 id="353-进程的通信方式">
  3.5.3 进程的通信方式
  <a class="anchor" href="#353-%e8%bf%9b%e7%a8%8b%e7%9a%84%e9%80%9a%e4%bf%a1%e6%96%b9%e5%bc%8f">#</a>
</h2>
<h3 id="信号">
  信号
  <a class="anchor" href="#%e4%bf%a1%e5%8f%b7">#</a>
</h3>
<p>信号是进程间通信方式之一，典型用法是：终端用户输入中断命令，通过信号机制停止一个程序的运行。</p>
<p><code>kill -l</code>可以查看所有的信号。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/39e9e806501c4182bcb2890a096e4867.png" width=  /></div>
<ul>
<li>SIGINT 通知前台进程组终止进程 ctrl+C</li>
<li>SIGKILL立即结束程序，不能被阻塞和处理 kil -9 pid</li>
</ul>
<h2 id="355-守护进程和系统日志">
  3.5.5 守护进程和系统日志
  <a class="anchor" href="#355-%e5%ae%88%e6%8a%a4%e8%bf%9b%e7%a8%8b%e5%92%8c%e7%b3%bb%e7%bb%9f%e6%97%a5%e5%bf%97">#</a>
</h2>
<p>nohup 和 daemon 都是 Linux/Unix 系统中的概念，它们都可以让程序在后台运行，但它们的实现方式和作用有所不同。</p>
<p>nohup 更适合运行一次性任务，而 daemon 更适合长期运行的系统服务。nohup 通常将输出信息重定向到文件中，而 daemon 通常将输出信息写入到系统日志中。</p>
<h3 id="nohup">
  nohup
  <a class="anchor" href="#nohup">#</a>
</h3>
<p>nohup 命令使进程忽路 hangup（挂起）信号，即使终端关闭服务也不会停止，一般配置 &amp; 使用。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/c72161edf8d94fb6af6d73d86ca87499.png" width=  /></div>
<blockquote class="book-hint info">
  /proc/ 目录在硬盘上是不存在，是操作系统读取内存的信息以文件的方式进行呈现，用户可以像操作文件一样操作这些，大多数的操作都是查看。
</blockquote>

<h3 id="daemon">
  daemon
  <a class="anchor" href="#daemon">#</a>
</h3>
<p>daemon是守护进程的一种实现方式。守护进程是指在后台运行的一类长期运行的进程，通常不与任何终端关联。它们通常在系统启动时启动，并且在系统关闭时停止。守护进程通常用于提供一些系统服务，如网络服务、系统日志、计划任务等。</p>
<p>与 nohup 不同的是，守护进程通常会将自己的进程号（PID）写入到一个文件中，以便于其他程序查询和控制它。同时，守护进程通常会把自己从父进程中分离出来，以避免与其他进程产生关联。</p>
<p>另外，守护进程通常会将输出信息写入到系统日志中，而不是输出到控制台。这可以让系统管理员更方便地查看守护进程的状态和运行日志。</p>
<h3 id="screen">
  screen
  <a class="anchor" href="#screen">#</a>
</h3>
<p>screen 可以规避因网络问题导致的异常，比如正在操作终端，突然终端断开了，再次连接时就不能回到上次的执行环境了。</p>
<p>如果没有 screen 命令可以进行安装。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install screen -y
</span></span></code></pre></div><ul>
<li>输入 screen 进入 screen 环境</li>
<li>ctrl+a 再按 d 退出（detached） screen 环境，当按 ctrl+a 时是没有反应的要注意。</li>
<li>screen -ls 查看 screen 的会话</li>
<li>screen -r sessionid 恢复会话</li>
</ul>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230217/282e532858db45c8befe5401bd4031b8.png" width=  /></div>
<h3 id="常见系统日志">
  常见系统日志
  <a class="anchor" href="#%e5%b8%b8%e8%a7%81%e7%b3%bb%e7%bb%9f%e6%97%a5%e5%bf%97">#</a>
</h3>
<ul>
<li>
<p>/var/log/messages：是一个系统日志文件，包含系统进程和服务的日志信息，包括系统启动、关机、登录和注销信息，以及用户和系统进程发出的警告和错误信息。这些日志信息对于排除系统问题和调试应用程序非常有用。</p>
</li>
<li>
<p>/var/log/dmesg：提供了关于硬件设备、驱动程序和内核模块的详细信息，以及任何可能会影响系统操作的错误或警告消息，可以帮助诊断与硬件相关的问题，例如设备驱动程序或文件系统错误等。</p>
</li>
<li>
<p>/var/log/secure： 包含系统认证和安全相关的消息，如登录和注销信息，sudo 命令的使用，以及系统和应用程序的安全事件。这些日志信息对于跟踪和分析安全事件非常有用。</p>
</li>
</ul>
<h2 id="355-systemctl">
  3.5.5 systemctl
  <a class="anchor" href="#355-systemctl">#</a>
</h2>
<p>service 对于服务的启动和停止的控制好坏完全决定与写脚本的同学，systemctl 是对 service 功能的强化。</p>
<p>service 的启动脚本放在 /etc/init.d 目录。systemctl 的脚本放在 /usr/lib/systemd/system 目录。一般 service 的脚本行数和复杂程度远大于 systemctl。</p>
<p>systemctl 的运行级别在目录 /lib/systemd/system 下，.service 文件表示服务，.target 文件表示运行级别。</p>
<p>
  <img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230221/d41adf15c8584bbcb339a0b509badb95.png?imageView2/0/q/75%7cwatermark/2/text/eGlhb2JpbnF0/font/dmlqYXlh/fontsize/1000/fill/IzVDNUI1Qg==/dissolve/52/gravity/SouthEast/dx/15/dy/15" alt="" /></p>
<h3 id="常见操作">
  常见操作
  <a class="anchor" href="#%e5%b8%b8%e8%a7%81%e6%93%8d%e4%bd%9c">#</a>
</h3>
<ul>
<li>systemctl start|stop|restart|reload enable disable 服务名称</li>
</ul>
<p>查看当前系统的运行级别</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>systemctl get-default
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置默认的启动级别</span>
</span></span><span style="display:flex;"><span>systemctl set-default multi-user.target
</span></span></code></pre></div><h2 id="351-selinux-简介">
  3.5.1 SELinux 简介
  <a class="anchor" href="#351-selinux-%e7%ae%80%e4%bb%8b">#</a>
</h2>
<p>SELinux 是 Security Enhanced Linux 缩写，采用委任式存取控制，是在进行程序、文件等细节权限设置依据的一个核心模块。</p>
<h3 id="自主式dac">
  自主式（DAC）
  <a class="anchor" href="#%e8%87%aa%e4%b8%bb%e5%bc%8fdac">#</a>
</h3>
<p>当程序要操作文件时，系统根据程序的 Owner/Group，对比文件的权限，若通过权限检查，则可操作文件，但可能造成问题：</p>
<ul>
<li>root 具有最高权限，若某程序属于 root，则该程序可操作系统的任何文件；</li>
<li>使用者可利用程序来变更文件的权限。</li>
</ul>
<h3 id="委任式mac">
  委任式（MAC）
  <a class="anchor" href="#%e5%a7%94%e4%bb%bb%e5%bc%8fmac">#</a>
</h3>
<p>也即是 SELinux 所采用的方式，可针对特定程序与特定文件来进行权限的控制。</p>
<ul>
<li>即使是 root，在使用不同程序时所取到的权限也不一定是 root，而是根据该程序的设定；</li>
<li>程序也不能任意使用系统文件，因为每个文件也有针对该程序可用的权限设定。</li>
</ul>
<h3 id="常见命令">
  常见命令
  <a class="anchor" href="#%e5%b8%b8%e8%a7%81%e5%91%bd%e4%bb%a4">#</a>
</h3>
<p>selinux 配置文件在 /etc/selinux/config 里，可以直接修改配置文件让其生效，修改后需要重启系统。</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230221/458dcd0f10e64c1381c21df04473cc76.png" width=  /></div>
<p>临时修改可以使用 setenforce 命令</p>
<div align="center"><img src="https://cdn.xiaobinqt.cn/xiaobinqt.io/20230221/c980aa3e9004447d957c3bef26465272.png" width=  /></div>
<h2 id="参考">
  参考
  <a class="anchor" href="#%e5%8f%82%e8%80%83">#</a>
</h2>
<ul>
<li>
  <a href="https://blog.csdn.net/weixin_40734030/article/details/125558689">top命令详细解读</a></li>
<li>
  <a href="https://blog.csdn.net/qq_35258036/article/details/125932224">Linux基础——SELinux</a></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/xiaobinqt/xiaobinqt.github.io/commit/9d12db52d6281a8d5448efc8a5b90928839081d5" title='最后修改者 weibin | February 21, 2023' target="_blank" rel="noopener">
      <img src="/linux/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>February 21, 2023</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/xiaobinqt/xiaobinqt.github.io/tree/main/content/docs/part3-sys-manage/3.5-process.md" target="_blank" rel="noopener">
      <img src="/linux/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>


</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#35-进程管理">3.5 进程管理</a>
      <ul>
        <li><a href="#351-进程查看">3.5.1 进程查看</a>
          <ul>
            <li><a href="#ps">ps</a></li>
            <li><a href="#pstree">pstree</a></li>
            <li><a href="#top">top</a></li>
          </ul>
        </li>
        <li><a href="#352-进程的控制命令">3.5.2 进程的控制命令</a>
          <ul>
            <li><a href="#调整优先级">调整优先级</a></li>
            <li><a href="#作业控制">作业控制</a></li>
            <li><a href="#jobs">jobs</a></li>
          </ul>
        </li>
        <li><a href="#353-进程的通信方式">3.5.3 进程的通信方式</a>
          <ul>
            <li><a href="#信号">信号</a></li>
          </ul>
        </li>
        <li><a href="#355-守护进程和系统日志">3.5.5 守护进程和系统日志</a>
          <ul>
            <li><a href="#nohup">nohup</a></li>
            <li><a href="#daemon">daemon</a></li>
            <li><a href="#screen">screen</a></li>
            <li><a href="#常见系统日志">常见系统日志</a></li>
          </ul>
        </li>
        <li><a href="#355-systemctl">3.5.5 systemctl</a>
          <ul>
            <li><a href="#常见操作">常见操作</a></li>
          </ul>
        </li>
        <li><a href="#351-selinux-简介">3.5.1 SELinux 简介</a>
          <ul>
            <li><a href="#自主式dac">自主式（DAC）</a></li>
            <li><a href="#委任式mac">委任式（MAC）</a></li>
            <li><a href="#常见命令">常见命令</a></li>
          </ul>
        </li>
        <li><a href="#参考">参考</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












